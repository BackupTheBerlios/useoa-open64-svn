	SUBROUTINE VMGAS(FV,T,P,GASRES)
C
C USED TO BE      FUNCTION VMGAS (FV,T,P)
C     ***********************
C
C         CALCULATES MOLAL VOLUME (CU FT/LB MOL) OF STREAM WITH MOLAL
C         FLOWS FV, AS A GAS AT TEMPERATURE T (D FAHR) AND PRESS P (PSIA)
C         USES APPROX EQN FOR CORRESPONDING-STATE COMPRESSIBILITY
C         FACTOR CORRELATION
C
C         WRITTEN BY R.R. HUGHES             EES IDENT SP/VMG
C              LAST REVISION AUGUST 1, 1973
C

      COMMON /UNPT/ JOUT,KNTRL,KFLAG,NCP,NPTP,NCST,NREC,NEN,WTEN(5),
     1  WEN(5,12),PTPEN(5,6),COST(5),EN(100),KTLN(15)
c     COMMON /ACT/ WTEN(5),WEN(5,12),PTPEN(5,6),COST(5),EN(100)
c     COMMON /UNACT/ JOUT,KNTRL,KFLAG,NPTP,NCST,NREC,NEN,NCP,KTLN(15)
      COMMON /QP/ CSXX(12,28),ANAMC(12,6)
      DIMENSION FV(12)
C      EQUIVALENCE (TC,TR),(SUM,PR),(VC,PC),(ZC,Z)
C++++++++++++++++++++++++++++++++++++++++++++++++++
      REAL GASRES
C
        SUM=0.0
        TC=0.0
        VC=0.0
        ZC=0.0
        TA=T+459.67
C            SUM THE CRITICAL PROPERTIES
        DO 100 I=1,NCP
           SUM=SUM+FV(I)
           TC=TC+FV(I)*CSXX(I,1)
           VC=VC+FV(I)*CSXX(I,22)/62.43
           ZC=ZC+FV(I)*CSXX(I,21)
100     CONTINUE
C            WEIGHTED AVERAGE CRITICAL PROPERTIES
           TC=TC/SUM
           VC=VC/SUM
           ZC=ZC/SUM
C            GENERALIZED CORRELATION
           VC=10.7335*TC*ZC/VC
           TC=TA/TC
           SUM=P/VC
           ZA=1.0-19.38*SUM*EXP(-4.0*TC)
           BZ=-4.0928E-3
           ZB=BZ*SUM**2+0.15402*SUM+BZ/10
           ZC=AMAX1(ZA,ZB)
           GASRES=10.7335*TA*ZC/P
C
           RETURN
           END
